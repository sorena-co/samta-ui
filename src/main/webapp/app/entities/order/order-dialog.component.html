<form name="editForm" role="form" novalidate (ngSubmit)="save()" #editForm="ngForm">
    <div style="margin: 15px">
        <p-breadcrumb [model]="mapSiteItems"></p-breadcrumb>
    </div>
    <div class="modal-body">
        <jhi-alert-error></jhi-alert-error>
        <jhi-alert></jhi-alert>
        <p-steps [(activeIndex)]="activeIndex" [model]="items" styleClass="steps-custom"></p-steps>
        <div *ngIf="activeIndex===0">
            <div class="row">
                <div class="col-md-3">
                    <div class="form-group">
                        <label *ngIf="mode==='airplane'" class="form-control-label"
                               jhiTranslate="samtagatewayApp.order.locationCustomer"
                               for="field_locationId">Location Id</label>
                        <label *ngIf="mode!=='airplane'" class="form-control-label"
                               jhiTranslate="samtagatewayApp.order.locationId"
                               for="field_locationId">Location Id</label>
                        <app-location-level-selector
                            [multiSelect]="false"
                            [(ngModel)]="order.locationId"
                            class="form-control"
                            id="field_locationId"
                            widthGrid="300px"
                            (selectedItem)="locationChanged()"
                            [ngModelOptions]="{standalone: true}"
                            ngDefaultControl
                            name="locationId"
                        >
                        </app-location-level-selector>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="form-group">
                        <label class="form-control-label" jhiTranslate="samtagatewayApp.order.customerId"
                               for="field_customerPersons">field_customerPersons</label>
                        <sell-contract-customer-person-selector
                            [selectObject]="true"
                            [exportMode]="mode==='exchange'||mode==='export'"
                            (selectedItem)="changeCustomerPerson($event)"
                            [(ngModel)]="customerPerson"
                            class="form-control"
                            id="field_customerPersons"
                            widthGrid="450px"
                            [ngModelOptions]="{standalone: true}"
                            ngDefaultControl
                            [sellContractProducts]="customerPersons"
                            required
                            name="customerPersons"
                        >
                        </sell-contract-customer-person-selector>
                        <!-- <select [disabled]="isView"
                                 class="form-control"
                                 name="customerId"
                                 [(ngModel)]="order.customerId"
                                 id="field_customerId"
                                 (ngModelChange)="customerChanged($event)"
                                 required
                         >
                             <option [ngValue]="customersListOption.id"
                                     *ngFor="let customersListOption of customers">
                                 {{customersListOption.name}}
                             </option>
                         </select>-->
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="form-group">
                        <label *ngIf="mode==='airplane'" class="form-control-label"
                               jhiTranslate="samtagatewayApp.refuelCenter.home.title"
                               for="field_depotId">Depot
                            Id</label>
                        <label *ngIf="mode!=='airplane'" class="form-control-label"
                               jhiTranslate="samtagatewayApp.order.depotId"
                               for="field_depotId">Depot
                            Id</label>
                        <select [disabled]="isView"
                                class="form-control"
                                name="depotId"
                                [(ngModel)]="order.depotId"
                                id="field_depotId"
                                (ngModelChange)="depotChanged($event)"
                                required
                        >
                            <option [ngValue]="depotsListOption.id"
                                    *ngFor="let depotsListOption of depots">
                                {{depotsListOption.title}}
                            </option>
                        </select>

                    </div>
                </div>
                <div class="col-md-3">
                    <div class="form-group">
                        <label class="form-control-label" jhiTranslate="samtagatewayApp.order.registerDate"
                               for="field_registerDate">Register Date</label>
                        <div class="d-flex">
                            <ng2-datetimepicker [disableTime]="true" [disabled]="true" [rtlActive]="true" time="00:00"
                                                id="field_registerDate"
                                                class="form-control"
                                                name="registerDate" [(ngModel)]="serverDate"
                            ></ng2-datetimepicker>
                        </div>
                        <div [hidden]="isDay">
                            <small class="form-text text-danger"
                                   [hidden]="isDay" jhiTranslate="entity.validation.date.not.equal"
                                   translateValues="{day:'{{serverDate | dateJalali}}'}">
                                This field is required.
                            </small>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-3">
                    <div class="form-group">
                        <label class="form-control-label" jhiTranslate="samtagatewayApp.order.orderNo"
                               for="field_orderNo">Order
                            No</label>
                        <input [disabled]="mode!=='airplane'||isView" type="text" class="form-control" name="orderNo"
                               id="field_orderNo"
                               [(ngModel)]="order.orderNo" required/>
                        <div [hidden]="!(editForm.controls.orderNo?.dirty && editForm.controls.orderNo?.invalid)">
                            <small class="form-text text-danger"
                                   [hidden]="!editForm.controls.orderNo?.errors?.required"
                                   jhiTranslate="entity.validation.required">
                                This field is required.
                            </small>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="form-group">
                        <label class="form-control-label" jhiTranslate="samtagatewayApp.order.currencyId"
                               for="field_currencyId">Currency Id</label>

                        <select [disabled]="isView"
                                class="form-control"
                                name="currencyId"
                                [(ngModel)]="order.currencyId"
                                id="field_currencyId"
                                (ngModelChange)="currencyChanged($event)"
                                required
                        >
                            <option [ngValue]="currencyListOption.id"
                                    *ngFor="let currencyListOption of currencies">
                                {{currencyListOption.title}}
                            </option>
                        </select>
                    </div>
                </div>
                <div class="col-md-3" *ngIf="currency.isNationalCurrency!==true">
                    <div class="form-group">
                        <label class="form-control-label" jhiTranslate="samtagatewayApp.order.currencyRateGroupId"
                               for="field_currencyRateGroupId">Currency Rate Group Id</label>

                        <select [disabled]="isView"
                                class="form-control"
                                name="currencyRateGroupId"
                                [(ngModel)]="order.currencyRateGroupId"
                                id="field_currencyRateGroupId"
                                (ngModelChange)="currencyRateGroupChanged($event)"
                                required
                        >
                            <option [ngValue]="null"></option>
                            <option [ngValue]="currencyRateGroupListOption.id"
                                    *ngFor="let currencyRateGroupListOption of currencyRateGroups">
                                {{currencyRateGroupListOption.title}}
                            </option>
                        </select>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="form-group">
                        <label class="form-control-label" jhiTranslate="samtagatewayApp.order.buyType"
                               for="field_buyType">Pay
                            Type</label>
                        <select [disabled]="isView"
                                class="form-control"
                                name="buyType"
                                (ngModelChange)="buyTypeChanged($event)"
                                [(ngModel)]="order.buyGroup"
                                id="field_buyType"
                                required
                        >
                            <option [ngValue]="buyTypeListOption"
                                    *ngFor="let buyTypeListOption of buyGroups">
                                {{'samtagatewayApp.BuyGroup.'+buyTypeListOption | translate}}
                            </option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="row" *ngIf="mode==='airplane'">
                <ng-container *ngIf="mode==='airplane'">
                    <div class="col-md-3">
                        <div class="form-group">
                            <label class="form-control-label" jhiTranslate="samtagatewayApp.order.typeOfFuelReceipt"
                                   for="field_typeOfFuelReceipt">Type Of Fuel Receipt</label>
                            <!--                            <select class="form-control" name="typeOfFuelReceipt" [(ngModel)]="order.typeOfFuelReceipt"
                                                                (ngModelChange)="changeTypeOfFuelReceipt($event)"
                                                                id="field_typeOfFuelReceipt">
                                                            <option value="TANKER_SALES">{{'samtagatewayApp.TypeOfFuelReceipt.TANKER_SALES' |
                                                                translate}}
                                                            </option>
                                                            <option value="PIPE_LINE_SALES">{{'samtagatewayApp.TypeOfFuelReceipt.PIPE_LINE_SALES' |
                                                                translate}}
                                                            </option>
                                                            <option value="UNIT_TO_AIRPLANE">{{'samtagatewayApp.TypeOfFuelReceipt.UNIT_TO_AIRPLANE'
                                                                |
                                                                translate}}
                                                            </option>
                                                            <option value="UNIT_TO_CUSTOMERS">
                                                                {{'samtagatewayApp.TypeOfFuelReceipt.UNIT_TO_CUSTOMERS' |
                                                                translate}}
                                                            </option>
                                                        </select>-->
                            <select [disabled]="isView"
                                    class="form-control"
                                    name="typeOfFuelReceipt"
                                    (ngModelChange)="changeTypeOfFuelReceipt($event)"
                                    [(ngModel)]="order.typeOfFuelReceipt"
                                    id="field_typeOfFuelReceipt"
                                    required
                            >
                                <option [ngValue]="typeOfFuelReceiptListOption"
                                        *ngFor="let typeOfFuelReceiptListOption of typeOfFuelReceipt">
                                    {{'samtagatewayApp.TypeOfFuelReceipt.'+typeOfFuelReceiptListOption | translate}}
                                </option>
                            </select>
                        </div>
                    </div>
                    <div class="col-md-3"
                         *ngIf="order.typeOfFuelReceipt!==TypeOfFuelReceipt[TypeOfFuelReceipt.PIPE_LINE_SALES]">
                        <div class="row">
                            <div [ngClass]="{'col-md-12':order.typeOfFuelReceipt===TypeOfFuelReceipt[TypeOfFuelReceipt.PIPE_LINE_SALES],
                                        'col-md-6':order.typeOfFuelReceipt!==TypeOfFuelReceipt[TypeOfFuelReceipt.PIPE_LINE_SALES]}"
                                 *ngIf="order.typeOfFuelReceipt===TypeOfFuelReceipt[TypeOfFuelReceipt.UNIT_TO_AIRPLANE]">
                                <div class="form-group">
                                    <label class="form-control-label"
                                           jhiTranslate="samtagatewayApp.order.flightConditions"
                                           for="field_flightConditions">Flight Conditions</label>
                                    <select class="form-control" name="flightConditions"
                                            [(ngModel)]="order.flightConditions"
                                            (ngModelChange)="onChangeFlightConditions($event)"
                                            id="field_flightConditions">
                                        <option value="VIP">{{'samtagatewayApp.FlightConditions.VIP' | translate}}
                                        </option>
                                        <option value="EMERGENCY">{{'samtagatewayApp.FlightConditions.EMERGENCY' |
                                            translate}}
                                        </option>
                                        <option value="NORMAL">{{'samtagatewayApp.FlightConditions.NORMAL' |
                                            translate}}
                                        </option>
                                    </select>
                                </div>
                            </div>
                            <div [ngClass]="{'col-md-12':order.typeOfFuelReceipt!==TypeOfFuelReceipt[TypeOfFuelReceipt.UNIT_TO_AIRPLANE],
                                        'col-md-6':order.typeOfFuelReceipt===TypeOfFuelReceipt[TypeOfFuelReceipt.UNIT_TO_AIRPLANE]}"

                                 *ngIf="order.typeOfFuelReceipt!==TypeOfFuelReceipt[TypeOfFuelReceipt.PIPE_LINE_SALES]">
                                <div class="form-group">
                                    <label class="form-control-label"
                                           jhiTranslate="samtagatewayApp.logBook.fuelType" for="field_fuelType">Fuel
                                        Type</label>
                                    <select class="form-control" name="fuelType" [(ngModel)]="order.fuelType"
                                            (ngModelChange)="onChangeFuelType($event)"
                                            [disabled]="isView || order.typeOfFuelReceipt===TypeOfFuelReceipt[TypeOfFuelReceipt.TANKER_SALES]"
                                            id="field_fuelType" required>
                                        <option value="FUEL">{{'samtagatewayApp.FuelType.FUEL' | translate}}
                                        </option>
                                        <option value="DE_FUEL">{{'samtagatewayApp.FuelType.DE_FUEL' |
                                            translate}}
                                        </option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">

                        <div class="form-group">
                            <label class="form-control-label" jhiTranslate="samtagatewayApp.order.sourceAirport"
                                   for="field_sourceAirport">Source RefuelCenter</label>
                            <div class="form-group">
                                <select class="form-control" id="field_sourceAirport" name="sourceAirport"
                                        [(ngModel)]="order.sourceAirport"
                                        (ngModelChange)="onChangeFlightConditions($event)"
                                        [disabled]="isView || isEdit"
                                        required>
                                    <option *ngIf="!editForm.value.refuelCenter" [ngValue]="null" selected></option>
                                    <option [ngValue]="refuelCenterOption.id"
                                            *ngFor="let refuelCenterOption of sourceAirports; trackBy: trackRefuelCenterById">
                                        {{refuelCenterOption.persianTitle}}
                                    </option>
                                </select>
                            </div>
                        </div>

                        <div
                            [hidden]="!(editForm.controls.refuelCenter?.dirty && editForm.controls.refuelCenter?.invalid)">
                            <small class="form-text text-danger"
                                   [hidden]="!editForm.controls.refuelCenter?.errors?.required"
                                   jhiTranslate="entity.validation.required">
                                This field is required.
                            </small>
                        </div>
                    </div>
                </ng-container>
                <div class="col-md-3"
                     *ngIf="order.typeOfFuelReceipt===TypeOfFuelReceipt[TypeOfFuelReceipt.UNIT_TO_AIRPLANE]">
                    <div class="form-group">
                        <label class="form-control-label" jhiTranslate="samtagatewayApp.order.targetAirport"
                               for="field_targetAirport">Target RefuelCenter</label>
                       <!-- <select class="form-control" id="field_targetAirport" name="targetAirport"
                                [disabled]="isView || isEdit"
                                (ngModelChange)="onChangeTargetRefuelCenter($event)"
                                [(ngModel)]="order.targetAirport" required>
                            <option *ngIf="!editForm.value.refuelCenter" [ngValue]="null" selected></option>
                            <option [ngValue]="refuelCenterOption.id"
                                    *ngFor="let refuelCenterOption of targetAirports; trackBy: trackRefuelCenterById">
                                {{refuelCenterOption.persianTitle}}
                            </option>
                        </select>-->

                        <app-airport-order-selector
                            *ngIf="targetAirports!=null"
                            [multiSelect]="false"
                            [(ngModel)]="order.targetAirport"
                            id="field_targetAirports"
                            class="form-control"
                            widthGrid="300px"
                            [ngModelOptions]="{standalone: true}"
                            ngDefaultControl
                            [inputAirports]="targetAirports"
                            name="targetAirports"
                            [disabled]="isView || isEdit"
                            required
                        >
                        </app-airport-order-selector>

                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-12">
                    <div class="form-group">
                        <label class="form-control-label" jhiTranslate="samtagatewayApp.order.description"
                               for="field_description">Description</label>
                        <textarea [disabled]="isView" type="text" class="form-control" name="description"
                                  id="field_description"
                                  [(ngModel)]="order.description"></textarea>

                    </div>
                </div>
            </div>
        </div>
        <div *ngIf="activeIndex===1">
            <div class="card">
                <div class="card-header">
                    <div class="row">
                        <h5 class="col-md-3"
                            jhiTranslate="samtagatewayApp.order.home.titleInfo">
                            Create or edit
                        </h5>
                        <div class="col-md-8"></div>
                    </div>
                </div>
                <div class="card-header">
                    <div class="row">
                        <div class="col-md-3">
                            <div class="col-md-12">
                                <label jhiTranslate="samtagatewayApp.customer.home.title"></label>
                            </div>
                            <div class="col-md-12">
                                {{order.customerName != null ? order.customerName + "(" + order.customerCode +
                                ")":order.personName}}
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="col-md-12">
                                <label *ngIf="mode == 'order'" jhiTranslate="samtagatewayApp.order.orderNo"></label>
                                <label *ngIf="mode == 'airplane'"
                                       jhiTranslate="samtagatewayApp.order.orderNoFuelReceipt"></label>
                            </div>
                            <div class="col-md-12">
                                {{order.orderNo}}
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="col-md-12">
                                <label jhiTranslate="samtagatewayApp.depot.home.title"></label>
                            </div>
                            <div class="col-md-12">
                                {{order.depotTitle}}
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="col-md-12">
                                <label jhiTranslate="samtagatewayApp.buyType.home.title"></label>
                            </div>
                            <div class="col-md-12">
                                {{'samtagatewayApp.BuyGroup.'+order.buyGroup | translate}}
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="col-md-12">
                                <label jhiTranslate="samtagatewayApp.order.registerDate"></label>
                            </div>
                            <div class="col-md-12">
                                {{order.registerDate | dateJalali}}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <br/>
            <div class="card">
                <div class="card-header">
                    <div class="row">
                        <h5 class="col-md-3"
                            jhiTranslate="samtagatewayApp.sellContractProduct.home.cardTitle">
                            Create or edit
                        </h5>
                        <div class="col-md-8"></div>
                    </div>
                </div>
                <div class="card-block container" [style.background-color]="orderProduct.productColor">
                    <form name="editFormProduct"
                          role="form" novalidate (ngSubmit)="save()" #editFormProduct="ngForm">
                        <div class="row">
                            <div
                                [ngClass]="{'col-xs-12 col-md-6':mode!='airplane'
                                ,'col-xs-12 col-md-4':mode==='airplane'}">
                                <div class="form-group">
                                    <label jhiTranslate="samtagatewayApp.sellContractProduct.product"
                                           for="field_product">Product</label>
                                    <!--  <sell-contract-product-selector
                                          [multiSelect]="false"
                                          (ngModelChange)="changeProducts($event)"
                                          [(ngModel)]="orderProduct.sellContractProductId" class="form-control"
                                          id="field_product"
                                          widthGrid="500px"
                                          [ngModelOptions]="{standalone: true}"
                                          ngDefaultControl
                                          [sellContractProducts]="sellContractProducts"
                                          required
                                          name="product"
                                      >
                                      </sell-contract-product-selector>-->
                                    <sell-contract-product-selector
                                        [multiSelect]="false"
                                        (ngModelChange)="changeProducts($event)"
                                        [(ngModel)]="orderProduct.sellContractProductId" class="form-control"
                                        id="field_product"
                                        widthGrid="500px"
                                        [ngModelOptions]="{standalone: true}"
                                        ngDefaultControl
                                        [showFields]="{sellContractNumber:true,productTitle:true,currencyRateGroupTitle:true}"
                                        [sellContractProducts]="sellContractProducts"
                                        required
                                        name="product"
                                    >
                                    </sell-contract-product-selector>
                                </div>
                            </div>
                            <div
                                [ngClass]="{'col-xs-12 col-md-6':mode!=='airplane'
                                ,'col-xs-12 col-md-4':mode==='airplane'}">
                                <div class="form-group">
                                    <label class="form-control-label"
                                           jhiTranslate="samtagatewayApp.orderProduct.amount"
                                           for="field_amount">Amount</label>
                                    <input type="number" class="form-control" name="amount" id="field_amount"
                                           [disabled]="isView"
                                           (input)="onChangeAmount($event.target.value)"
                                           [(ngModel)]="orderProduct.amount"
                                           required
                                    />
                                </div>

                            </div>
                            <ng-container *ngIf="mode==='airplane'">
                                <div class="col-xs-12 col-md-4">
                                    <div class="form-group">
                                        <label class="form-control-label"
                                               jhiTranslate="samtagatewayApp.changeContainer.dayDepot"
                                               for="field_dayDepots">Day Depot</label>
                                        <select [disabled]="isView" class="form-control" id="field_dayDepots"
                                                name="dayDepots"
                                                (ngModelChange)="onChangeDayDepot($event)"
                                                [(ngModel)]="logBook.dayDepotId" required>
                                            <option *ngIf="!editForm.value.dayDepot" [ngValue]="null" selected></option>
                                            <option *ngFor="let dayDepotOption of dayDepots; trackBy: trackDayDepotById"
                                                    [ngValue]="dayDepotOption.id">
                                                {{dayDepotOption.oilTankTitle}}
                                            </option>
                                        </select>
                                    </div>
                                    <div
                                        [hidden]="!(editForm.controls.dayDepot?.dirty && editForm.controls.dayDepot?.invalid)">
                                        <small class="form-text text-danger"
                                               [hidden]="!editForm.controls.dayDepot?.errors?.required"
                                               jhiTranslate="entity.validation.required">
                                            This field is required.
                                        </small>
                                    </div>
                                </div>
                                <div class="col-xs-12 col-md-4"
                                     *ngIf="order.typeOfFuelReceipt!==TypeOfFuelReceipt[TypeOfFuelReceipt.PIPE_LINE_SALES]">
                                    <div class="form-group">
                                        <label class="form-control-label" jhiTranslate="samtagatewayApp.transfer.metre"
                                               for="field_metre">Metre</label>
                                        <select class="form-control" id="field_metre" name="metre"
                                                (ngModelChange)="changeMetre($event)"
                                                [disabled]="isView"
                                                [(ngModel)]="metreLog.metreId" required>
                                            <option [ngValue]="null"></option>
                                            <option [ngValue]="metreOption.id"
                                                    *ngFor="let metreOption of metres; trackBy: trackMetreById">
                                                {{metreOption.title}}
                                            </option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-xs-12 col-md-4"
                                     *ngIf="order.typeOfFuelReceipt!==TypeOfFuelReceipt[TypeOfFuelReceipt.PIPE_LINE_SALES]">
                                    <!--[ngClass]="{'col-xs-12 col-md-3':order.typeOfFuelReceipt!==TypeOfFuelReceipt[TypeOfFuelReceipt.TANKER_SALES],
                                    'col-xs-12 col-md-4':order.typeOfFuelReceipt===TypeOfFuelReceipt[TypeOfFuelReceipt.TANKER_SALES]}"
                                     *ngIf="order.typeOfFuelReceipt!==TypeOfFuelReceipt[TypeOfFuelReceipt.PIPE_LINE_SALES]" -->

                                    <div class="form-group">
                                        <label class="form-control-label"
                                               jhiTranslate="samtagatewayApp.metreLog.startMeter"
                                               for="field_startMeter">Start Meter</label>
                                        <input [disabled]="true" type="number" class="form-control" name="startMeter"
                                               id="field_startMeter"
                                               [(ngModel)]="metreLog.startMeter" required/>
                                    </div>
                                </div>
                                <div class="col-xs-12 col-md-4"
                                     *ngIf="order.typeOfFuelReceipt!==TypeOfFuelReceipt[TypeOfFuelReceipt.PIPE_LINE_SALES]">
                                    <!--[ngClass]="{'col-xs-12 col-md-3':order.typeOfFuelReceipt!==TypeOfFuelReceipt[TypeOfFuelReceipt.TANKER_SALES],
                                    'col-xs-12 col-md-4':order.typeOfFuelReceipt===TypeOfFuelReceipt[TypeOfFuelReceipt.TANKER_SALES]}"
                                     *ngIf="order.typeOfFuelReceipt!==TypeOfFuelReceipt[TypeOfFuelReceipt.PIPE_LINE_SALES]"-->

                                    <div class="form-group">
                                        <label class="form-control-label"
                                               jhiTranslate="samtagatewayApp.metreLog.endMeter"
                                               for="field_endMeter">Start Meter</label>
                                        <input [disabled]="true" type="number" class="form-control" name="endMeter"
                                               id="field_endMeter"
                                               [(ngModel)]="metreLog.endMeter" required/>
                                    </div>
                                </div>
                            </ng-container>
                        </div>
                    </form>
                </div>
                <div class="card-footer pull-right text-right">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal" (click)="cancelProduct()">
                        <span class="fa fa-ban"></span>&nbsp;<span
                        jhiTranslate="entity.action.cancelProduct">Cancel</span>
                    </button>
                    <button type="button" class="btn btn-primary"
                            [disabled]="editFormProduct.form.invalid || isSaving||orderProduct.sellContractProductId==null"
                            (click)="addOrderProduct()">
                        <span class="fa fa-save"></span>&nbsp;<span
                        jhiTranslate="entity.action.saveProduct">Save</span>
                    </button>
                </div>
                <p-dataTable
                    #dt
                    [value]="order.orderProducts"
                    [immutable]="false"
                    [responsive]="true"
                    [stacked]="false"
                >
                    <p-headerColumnGroup>
                        <p-row>
                            <!--todo background-color-->
                            <p-column field="productTitle" [sortable]="true">
                                <ng-template pTemplate="header">
                                    <span jhiTranslate="samtagatewayApp.sellContractProduct.product">Product</span>
                                </ng-template>
                            </p-column>
                            <p-column field="rateGroupTitle" [sortable]="true">
                                <ng-template pTemplate="header">
                                <span
                                    jhiTranslate="samtagatewayApp.sellContractProduct.rateGroupId">Rate Group Id</span>
                                </ng-template>
                            </p-column>
                            <p-column field="amount" [sortable]="true">
                                <ng-template pTemplate="header">
                                <span
                                    jhiTranslate="samtagatewayApp.orderProduct.amount">Amount</span>
                                </ng-template>
                            </p-column>
                            <p-column field="productCost" [sortable]="true">
                                <ng-template pTemplate="header">
                                <span
                                    jhiTranslate="samtagatewayApp.orderProduct.productCost">Product Cost</span>
                                </ng-template>
                            </p-column>
                            <p-column field="productRateId" [sortable]="true">
                                <ng-template pTemplate="header">
                                <span
                                    jhiTranslate="samtagatewayApp.orderProduct.productRateId">productRateId</span>
                                </ng-template>
                            </p-column>
                            <p-column field="productPrice" [sortable]="true">
                                <ng-template pTemplate="header">
                                <span
                                    jhiTranslate="samtagatewayApp.orderProduct.productPrice">Product Price</span>
                                </ng-template>
                            </p-column>
                            <p-column styleClass="col-button">
                                <ng-template pTemplate="header">
                                </ng-template>
                            </p-column>
                        </p-row>
                    </p-headerColumnGroup>
                    <p-column field="sellContractProductTitle"
                              [header]="'samtagatewayApp.sellContractProduct.product' | translate">
                        <ng-template let-item="rowData" pTemplate="body">
                            <span [style.color]="item.productColor">{{item.sellContractProductTitle}}</span>
                        </ng-template>
                    </p-column>
                    <p-column field="rateGroupTitle"
                              [header]="'samtagatewayApp.sellContractProduct.rateGroupId' | translate">
                        <ng-template let-item="rowData" pTemplate="body">
                            <span [style.color]="item.productColor">{{item.rateGroupTitle}}</span>
                        </ng-template>
                    </p-column>
                    <p-column field="amount"
                              [header]="'samtagatewayApp.orderProduct.amount' | translate">
                        <ng-template let-item="rowData" pTemplate="body">
                            <span [style.color]="item.productColor">{{item.amount}}</span>
                        </ng-template>
                    </p-column>
                    <p-column field="productCost"
                              [header]="'samtagatewayApp.orderProduct.productCost' | translate">
                        <ng-template let-item="rowData" pTemplate="body">
                            <app-order-cost-table
                                [multiSelect]="false"
                                [costResponses]="item.costResponses"
                                [productCost]="item.productCost"
                                [productColor]="item.productColor"
                                id="field_productCost"
                                widthGrid="300px"
                                ngDefaultControl
                                name="productCost"
                            >
                            </app-order-cost-table>
                        </ng-template>
                    </p-column>
                    <p-column field="ratePrice"
                              [header]="'samtagatewayApp.orderProduct.productRateId' | translate">
                        <ng-template let-item="rowData" pTemplate="body">
                            <span [style.color]="item.productColor">{{item.ratePrice}}</span>
                        </ng-template>
                    </p-column>
                    <p-column field="price"
                              [header]="'samtagatewayApp.orderProduct.productPrice' | translate">
                        <ng-template let-item="rowData" pTemplate="body">
                            <span [style.color]="item.productColor">{{item.price}}</span>
                        </ng-template>
                    </p-column>
                    <p-column class="component">
                        <ng-template let-item="rowData" pTemplate="body">
                            <div class="btn-group" ngbDropdown placement="right">
                                <button type="button" class="btn btn-danger"
                                        (click)="removeProduct(item.sellContractProductId)">
                                    <span class="fa fa-remove"></span>
                                    <span jhiTranslate="entity.action.delete">delete</span>
                                </button>
                                <button type="button" class="btn btn-primary"
                                        (click)="editProduct(item)">
                                    <span class="fa fa-remove"></span>
                                    <span jhiTranslate="entity.action.edit">edit</span>
                                </button>
                            </div>
                        </ng-template>
                    </p-column>
                </p-dataTable>
            </div>
            <div class="row">
                <div class="col-md-3">
                    <div class="form-group">
                        <label class="form-control-label" jhiTranslate="samtagatewayApp.order.price" for="field_price">Price</label>
                        <input [disabled]="true" type="number" class="form-control" name="price" id="field_price"
                               [(ngModel)]="order.price"/>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="form-group">
                        <label class="form-control-label" jhiTranslate="samtagatewayApp.order.productPrice"
                               for="field_productPrice">Product Price</label>
                        <input [disabled]="true" type="number" class="form-control" name="productPrice"
                               id="field_productPrice"
                               [(ngModel)]="order.productPrice"/>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="form-group">
                        <label class="form-control-label" jhiTranslate="samtagatewayApp.order.containerPrice"
                               for="field_containerPrice">Container Price</label>
                        <input [disabled]="true" type="number" class="form-control" name="containerPrice"
                               id="field_containerPrice"
                               [(ngModel)]="order.containerPrice"/>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="form-group">
                        <label class="form-control-label" jhiTranslate="samtagatewayApp.order.costPrice"
                               for="field_costPrice">Cost Price</label>
                        <input [disabled]="true" type="number" class="form-control" name="costPrice"
                               id="field_costPrice"
                               [(ngModel)]="order.costPrice"/>
                    </div>
                </div>

            </div>
        </div>
        <div *ngIf="activeIndex===2 && order.buyGroup==='CASH'">
            <div class="card">
                <div class="card-header">
                    <div class="row">
                        <h5 class="col-md-3"
                            jhiTranslate="samtagatewayApp.order.home.titleInfo">
                            Create or edit
                        </h5>
                        <div class="col-md-8"></div>
                    </div>
                </div>
                <div class="card-header">
                    <div class="row">
                        <div class="col-md-3">
                            <div class="col-md-12">
                                <label jhiTranslate="samtagatewayApp.customer.home.title"></label>
                            </div>
                            <div class="col-md-12">
                                {{order.customerName != null ? order.customerName + "(" + order.customerCode +
                                ")":order.personName}}
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="col-md-12">
                                <label *ngIf="mode == 'order'" jhiTranslate="samtagatewayApp.order.orderNo"></label>
                                <label *ngIf="mode == 'airplane'"
                                       jhiTranslate="samtagatewayApp.order.orderNoFuelReceipt"></label>
                            </div>
                            <div class="col-md-12">
                                {{order.orderNo}}
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="col-md-12">
                                <label jhiTranslate="samtagatewayApp.depot.home.title"></label>
                            </div>
                            <div class="col-md-12">
                                {{order.depotTitle}}
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="col-md-12">
                                <label jhiTranslate="samtagatewayApp.buyType.home.title"></label>
                            </div>
                            <div class="col-md-12">
                                {{'samtagatewayApp.BuyGroup.'+order.buyGroup | translate}}
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="col-md-12">
                                <label jhiTranslate="samtagatewayApp.order.registerDate"></label>
                            </div>
                            <div class="col-md-12">
                                {{order.registerDate | dateJalali}}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <br/>
            <jhi-e-payment #ePayment [requestIdentifier]="payId"
                           [showButton]="false"
                           (status)="onPayStatus($event)"></jhi-e-payment>
        </div>
        <div *ngIf="activeIndex===2 && order.buyGroup!=='CASH'">
            <div class="card">
                <div class="card-header">
                    <div class="row">
                        <h5 class="col-md-3"
                            jhiTranslate="samtagatewayApp.order.home.titleInfo">
                            Create or edit
                        </h5>
                        <div class="col-md-8"></div>
                    </div>
                </div>
                <div class="card-header">
                    <div class="row">
                        <div class="col-md-3">
                            <div class="col-md-12">
                                <label jhiTranslate="samtagatewayApp.customer.home.title"></label>
                            </div>
                            <div class="col-md-12">
                                {{order.customerName != null ? order.customerName + "(" + order.customerCode +
                                ")":order.personName}}
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="col-md-12">
                                <label *ngIf="mode == 'order'" jhiTranslate="samtagatewayApp.order.orderNo"></label>
                                <label *ngIf="mode == 'airplane'"
                                       jhiTranslate="samtagatewayApp.order.orderNoFuelReceipt"></label>
                            </div>
                            <div class="col-md-12">
                                {{order.orderNo}}
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="col-md-12">
                                <label jhiTranslate="samtagatewayApp.depot.home.title"></label>
                            </div>
                            <div class="col-md-12">
                                {{order.depotTitle}}
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="col-md-12">
                                <label jhiTranslate="samtagatewayApp.buyType.home.title"></label>
                            </div>
                            <div class="col-md-12">
                                {{'samtagatewayApp.BuyGroup.'+order.buyGroup | translate}}
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="col-md-12">
                                <label jhiTranslate="samtagatewayApp.order.registerDate"></label>
                            </div>
                            <div class="col-md-12">
                                {{order.registerDate | dateJalali}}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <br/>
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0"
                        jhiTranslate="samtagatewayApp.sellContractProduct.home.cardTitle">
                        Create or edit
                    </h5>
                </div>
                <p-dataTable
                    #dt
                    [value]="order.orderProducts"
                    [immutable]="false"
                    [responsive]="true"
                    [stacked]="false"
                >
                    <p-headerColumnGroup>
                        <p-row>
                            <p-column field="productTitle" [sortable]="true">
                                <ng-template pTemplate="header">
                                    <span jhiTranslate="samtagatewayApp.sellContractProduct.product">Product</span>
                                </ng-template>
                            </p-column>
                            <p-column field="amount" [sortable]="true">
                                <ng-template pTemplate="header">
                                <span
                                    jhiTranslate="samtagatewayApp.orderProduct.amount">Amount</span>
                                </ng-template>
                            </p-column>
                            <p-column field="productRateId" [sortable]="true">
                                <ng-template pTemplate="header">
                                <span
                                    jhiTranslate="samtagatewayApp.orderProduct.productRateId">productRateId</span>
                                </ng-template>
                            </p-column>
                            <p-column field="productPrice" [sortable]="true">
                                <ng-template pTemplate="header">
                                <span
                                    jhiTranslate="samtagatewayApp.orderProduct.productPrice">Product Price</span>
                                </ng-template>
                            </p-column>
                            <p-column field="productCost" [sortable]="true">
                                <ng-template pTemplate="header">
                                <span
                                    jhiTranslate="samtagatewayApp.orderProduct.productCost">Product Cost</span>
                                </ng-template>
                            </p-column>
                        </p-row>
                    </p-headerColumnGroup>
                    <p-column field="sellContractProductTitle"
                              [header]="'samtagatewayApp.sellContractProduct.product' | translate"></p-column>
                    <p-column field="amount"
                              [header]="'samtagatewayApp.orderProduct.amount' | translate">
                        <ng-template let-item="rowData" pTemplate="body">
                            <label class="text-primary">
                                {{item.amount}}
                            </label>
                            <label class="text-danger">
                                {{'('+item.currentAmount+')'}}
                            </label>
                        </ng-template>
                    </p-column>
                    <p-column field="ratePrice"
                              [header]="'samtagatewayApp.orderProduct.productRateId' | translate">

                    </p-column>
                    <p-column class="component">
                        <ng-template let-item="rowData" pTemplate="body">
                            <label class="text-primary">
                                {{item.price}}
                            </label>
                            <label class="text-danger">
                                {{'('+item.currentPrice+')'}}
                            </label>
                        </ng-template>
                    </p-column>
                    <p-column class="component">
                        <ng-template let-item="rowData" pTemplate="body">
                            <label class="text-primary">
                                {{item.productCost}}
                            </label>
                            <label class="text-danger">
                                {{'('+item.currentProductCost+')'}}
                            </label>
                        </ng-template>
                    </p-column>
                </p-dataTable>
            </div>
            <div class="row">
                <div class="col-md-3">
                    <div class="form-group">
                        <label class="form-control-label" jhiTranslate="samtagatewayApp.order.price"
                               for="field_price2">Price</label>
                        <input [disabled]="true" type="number" class="form-control" name="price" id="field_price2"
                               [(ngModel)]="order.price"/>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="form-group">
                        <label class="form-control-label" jhiTranslate="samtagatewayApp.order.productPrice"
                               for="field_productPrice2">Product Price</label>
                        <input [disabled]="true" type="number" class="form-control" name="productPrice"
                               id="field_productPrice2"
                               [(ngModel)]="order.productPrice"/>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="form-group">
                        <label class="form-control-label" jhiTranslate="samtagatewayApp.order.containerPrice"
                               for="field_containerPrice2">Container Price</label>
                        <input [disabled]="true" type="number" class="form-control" name="containerPrice"
                               id="field_containerPrice2"
                               [(ngModel)]="order.containerPrice"/>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="form-group">
                        <label class="form-control-label" jhiTranslate="samtagatewayApp.order.costPrice"
                               for="field_costPrice2">Cost Price</label>
                        <input [disabled]="true" type="number" class="form-control" name="costPrice"
                               id="field_costPrice2"
                               [(ngModel)]="order.costPrice"/>
                    </div>
                </div>
            </div>
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0"
                        jhiTranslate="samtagatewayApp.orderProduct.creditList">
                        Create or edit
                    </h5>
                </div>
                <p-dataTable
                    #dt
                    [value]="customerCredits"
                    [immutable]="false"
                    [responsive]="true"
                    [stacked]="false"
                    [(selection)]="selectedCustomerCredits"
                    (onRowUnselect)="onSelect($event, false)"
                    (onRowSelect)="onSelect($event, true)"
                >
                    <p-headerColumnGroup>
                        <p-row>
                            <p-column [style]="{'width':'38px'}"></p-column>
                            <p-column field="creditNumber" [sortable]="true">
                                <ng-template pTemplate="header">
                                    <span
                                        jhiTranslate="samtagatewayApp.customerCredit.creditNumber">Credit Number</span>
                                </ng-template>
                            </p-column>
                            <p-column field="startDate" [sortable]="true">
                                <ng-template pTemplate="header">
                                    <span jhiTranslate="samtagatewayApp.customerCredit.startDate">Start Date</span>
                                </ng-template>
                            </p-column>
                            <p-column field="finishDate" [sortable]="true">
                                <ng-template pTemplate="header">
                                    <span jhiTranslate="samtagatewayApp.customerCredit.finishDate">Finish Date</span>
                                </ng-template>
                            </p-column>
                            <p-column field="currentCredit" [sortable]="true">
                                <ng-template pTemplate="header">
                                    <span
                                        jhiTranslate="samtagatewayApp.customerCredit.currentCredit">Current Credit</span>
                                </ng-template>
                            </p-column>
                            <p-column field="currentAmount" [sortable]="true">
                                <ng-template pTemplate="header">
                                    <span
                                        jhiTranslate="samtagatewayApp.customerCredit.currentAmount">Current Amount</span>
                                </ng-template>
                            </p-column>
                            <p-column field="productTitle" [sortable]="true">
                                <ng-template pTemplate="header">
                                    <span jhiTranslate="samtagatewayApp.customerCredit.product">productId</span>
                                </ng-template>
                            </p-column>
                        </p-row>
                    </p-headerColumnGroup>
                    <p-column [style]="{'width':'38px'}" selectionMode="multiple"></p-column>
                    <p-column field="creditNumber">
                        <ng-template let-item="rowData" pTemplate="body">
                            <span>{{item.creditNumber}}</span>
                            <label class="text-info"
                                   jhiTranslate="{{'samtagatewayApp.BuyTypeUsage.' + item.parentBuyTypeUsage}}">{{item.parentBuyTypeUsage}}</label>
                        </ng-template>
                    </p-column>
                    <p-column field="startDate" [header]="'samtagatewayApp.customerCredit.startDate' | translate">
                        <ng-template let-item="rowData" pTemplate="body">
                            <span>{{item.startDate | dateJalali}}</span>
                        </ng-template>
                    </p-column>
                    <p-column field="finishDate" [header]="'samtagatewayApp.customerCredit.finishDate' | translate">
                        <ng-template let-item="rowData" pTemplate="body">
                            <span>{{item.finishDate | dateJalali}}</span>
                        </ng-template>
                    </p-column>
                    <p-column field="currentCredit"
                              [header]="'samtagatewayApp.customerCredit.currentCredit' | translate"></p-column>
                    <p-column field="currentAmount"
                              [header]="'samtagatewayApp.customerCredit.currentAmount' | translate"></p-column>
                    <p-column field="productTitle"
                              [header]="'samtagatewayApp.customerCredit.product' | translate"></p-column>
                </p-dataTable>
            </div>

        </div>

    </div>
    <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal" (click)="clear()">
            <span class="fa fa-ban"></span>&nbsp;<span jhiTranslate="entity.action.cancel">Cancel</span>
        </button>
        <button *ngIf="!isView && (activeIndex==0 ||  activeIndex==1)" type="submit"
                [disabled]="editForm.form.invalid || isSaving"
                class="btn btn-primary">
            <span class="fa fa-save"></span>&nbsp;<span jhiTranslate="entity.action.save">Save</span>
        </button>
        <button type="button"
                [disabled]="editForm.form.invalid || isSaving"
                class="btn btn-success"
                data-dismiss="modal"
                (click)="nextStep()"
                *ngIf="activeIndex==0 ||  (activeIndex==1 && (mode !=='airplane'||(mode ==='airplane' && order.buyGroup === 'CASH')))"
        >
            <span class="fa fa-credit-card"></span>&nbsp;<span
            jhiTranslate="samtagatewayApp.order.nextStep">nextStep</span>
        </button>
        <button type="button"
                class="btn btn-secondary"
                data-dismiss="modal"
                (click)="back()"
                *ngIf="activeIndex==1||activeIndex==2"
        >
            <span class="fa fa-arrow-right"></span>&nbsp;<span jhiTranslate="samtagatewayApp.order.back">back</span>
        </button>
        <button type="button"
                [disabled]="(disableButtons && activeIndex==2 && order.buyGroup !== 'CASH' )||(activeIndex==1&&order.productPrice == 0)"
                class="btn btn-success"
                data-dismiss="modal"
                (click)="paymentFinal()"
                *ngIf="(activeIndex === 2 && (order.buyGroup !== 'CASH' || payStatus === 'BEGIN' )) ||(mode==='airplane' && order.buyGroup !== 'CASH' && activeIndex==1)"
        >
            <span class="fa fa-credit-card"></span>&nbsp;<span jhiTranslate="samtagatewayApp.order.paymentFinal">paymentFinal</span>
        </button>
        <button type="button"
                class="btn btn-success"
                data-dismiss="modal"
                [routerLink]="['/order/' + mode + '/' + order.id + '/print']"

                *ngIf="activeIndex === 2 && order.buyGroup === 'CASH' && payStatus === 'COMPLETE'"
        >
            <span class="fa fa-print"></span>&nbsp;<span jhiTranslate="entity.action.print">Print</span>
        </button>
        <button type="button"
                class="btn btn-success"
                data-dismiss="modal"
                (click)="nextStep()"
                *ngIf="activeIndex === 2 && order.buyGroup === 'CASH' && payStatus === 'PENDING'"
        >
            <span class="fa fa-refresh"></span>&nbsp;<span jhiTranslate="samtagatewayApp.order.paymentFinalAgain">paymentFinalAgain</span>
        </button>
    </div>
</form>
